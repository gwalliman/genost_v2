function Body(t,e,i){this.interpreter=t,this.body=e,this.code=i,this.stmtList=null,this.startLine=null,this.lineNum=null,this.finishLine=null,this.method=null,this.varTable=[];var r=this.interpreter.getCurrentLineTokens();1==r.length&&r[0]==TERMINALS.SYMBOLS.OPENBRACE?(this.lineNum=this.startLine=this.interpreter.getCurrentLineNum(),this.findCloseBrace(),this.interpreter.goToNextLine(),this.interpreter.getCurrentLineNum()!=this.finishLine&&(this.stmtList=new StmtList(this.interpreter,this,this.code))):(this.interpreter.error("BODY",this.interpreter.getCurrentLineNum(),this.interpreter.getCurrentLine(),"Body must begin with {"),this.findCloseBrace(),this.interpreter.setCurrentLineNum(finishLine),this.interpreter.goToNextLine())}Body.prototype.findCloseBrace=function(){for(var t=1;0!==t&&null!==this.interpreter.goToNextLine();){var e=this.interpreter.getCurrentLineTokens();1==e.length&&e[0]==TERMINALS.SYMBOLS.OPENBRACE?t++:1==e.length&&e[0]==TERMINALS.SYMBOLS.CLOSEBRACE&&t--}0===t?(this.finishLine=this.interpreter.getCurrentLineNum(),this.interpreter.setCurrentLineNum(this.startLine)):this.interpreter.error("BODY",this.interpreter.getCurrentLineNum(),this.interpreter.getCurrentLine(),"Body must end with }")},Body.prototype.getStmtList=function(){return this.stmtList},Body.prototype.getStartLine=function(){return this.startLine},Body.prototype.getFinishLine=function(){return this.finishLine},Body.prototype.print=function(){null!==this.stmtList?(this.interpreter.writeln("parse","BODY: Start Line "+this.startLine+", Finish Line "+this.finishLine),this.interpreter.writeln("parse","{"),null!==this.stmtList?this.stmtList.print():this.interpreter.write("parse","EMPTY BODY"),this.interpreter.write("parse","}")):this.interpreter.write("parse","EMPTY BODY")};
function Code(e,t){0===t.length&&(t=""),this.interpreter=e,this.codeString=t,this.codeLines=this.codeString.split("\n"),this.codeLength=this.codeLines.length,this.tokenizedCode=[]}Code.prototype.getCodeLength=function(){return this.codeLength},Code.prototype.getLine=function(e){return e>=0&&e<this.codeLength?this.codeLines[e]:void 0},Code.prototype.getTokenizedLine=function(e){return e>=0&&e<this.codeLength?this.tokenizedCode[e]:void 0},Code.prototype.checkAlphaNumeric=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e.charCodeAt(i),!(t>47&&58>t||t>64&&91>t||t>96&&123>t))return!1;return!0},Code.prototype.exciseString=function(e){e=e.substring(1,e.length);var t=e.split(TERMINALS.SYMBOLS.QUOTE);1==t.length;var i=t.shift(),n=t.join();return[TERMINALS.SYMBOLS.QUOTE+i+TERMINALS.SYMBOLS.QUOTE,n]},Code.prototype.implode=function(e,t,i,n){for(var r=Array(),o=i;n>=o;o++)r.push(e[o]);return r.join(t)},Code.prototype.tokenizeLine=function(e,t){var i=[];this.interpreter.writeln("tokenize","Line "+e+" Codeline: "+t);var n=t.trim().split(" ");this.interpreter.writeln("tokenize","Line "+e+" Pass: "+n);for(var r=0,o=n.length;o>r;r++){var s=n[r].trim();if(this.interpreter.writeln("tokenize","Line "+e+" Token "+r+": "+s),s.length>0)if(this.checkAlphaNumeric(s))this.interpreter.writeln("tokenize","Line "+e+" "+s+" is alphanumeric, pushing"),i.push(s);else{if(this.interpreter.writeln("tokenize","Line "+e+" "+s+" is not alphanumeric"),s.indexOf(TERMINALS.SYMBOLS.QUOTE>-1)&&s.substring(0,1)==TERMINALS.SYMBOLS.QUOTE){this.interpreter.writeln("tokenize","Line "+e+" "+s+" contains a Type 3 (string)");var h=this.implode(n," ",r,n.length-1),p=this.exciseString(h);if(i.push(p[0]),h=p[1])for(var L=this.tokenizeLine(e,h),u=0,a=L.length;a>u;u++)i.push(L[u]);return i}if(s.indexOf(TERMINALS.SYMBOLS.DASH)>-1&&s.substring(0,1)==TERMINALS.SYMBOLS.DASH){this.interpreter.writeln("tokenize","Line "+e+" "+s+" contains a Type 4 (negative number)");for(var l=1,d=2,c=TERMINALS.SYMBOLS.DASH;d<=s.length&&!isNaN(s.substring(l,d));)c+=s.substring(l,d),l++,d++;i.push(c);var g=s.substring(l,s.length),S=g+this.implode(n," ",r+1,n.length-1);if(S)for(var f=this.tokenizeLine(e,S),k=0,v=f.length;v>k;k++)i.push(f[k]);return i}this.interpreter.writeln("tokenize","Line "+e+"  "+s+" contains a Type 1 (symbol)");var T=TERMINALS.searchForTerminal(s,"SYMBOLS");if(T){var z=s.split(T),C=z.shift();this.interpreter.writeln("tokenize","Line "+e+" Left: "+C);var M=z.join();this.interpreter.writeln("tokenize","Line "+e+" Right: "+M),C&&i.push.apply(i,this.tokenizeLine(e,C)),i.push(T),M&&i.push.apply(i,this.tokenizeLine(e,M));break}}}return i},Code.prototype.tokenizeCode=function(){for(var e=0,t=this.codeLines.length;t>e;e++){var i=this.tokenizeLine(e,this.codeLines[e]);this.tokenizedCode.push(i)}},Code.prototype.printTokens=function(e){var t=e.join("|");return t},Code.prototype.printAllTokens=function(){var e=this,t="";return this.tokenizedCode.forEach(function(i){t+=e.printTokens(i)+"\n==========\n"}),t};
var INTERPRETER={varStack:{},methodTable:{},extMethodTable:{},currentLineNum:0,code:{},body:{},getCurrentLineNum:function(){return this.currentLineNum},setCurrentLineNum:function(e){e>=0&&e<=this.code.getCodeLength()&&(this.currentLineNum=e)},getCurrentLine:function(){return this.code.getLine(this.currentLineNum)},getCurrentLineTokens:function(){return this.code.getTokenizedLine(this.currentLineNum)},goToNextLine:function(){return this.currentLineNum<this.code.getCodeLength()&&this.currentLineNum++,this.code.getLine(this.currentLineNum)},initialize:function(){},loadCode:function(e){this.code=new Code(this,e),this.code.tokenizeCode()},parseCode:function(){this.body=new Body(this,null,this.code),console.log(this.body)},printAllTokens:function(){return this.code.printAllTokens()},messageMask:{},setMessageMask:function(e,n){this.messageMask[e]=n},canShowMessage:function(e){return this.messageMask.hasOwnProperty(e)&&this.messageMask[e]===!0?!0:!1},error:function(e,n,t,i){var o=e.toUpperCase()+" ERROR Near Line "+n+": "+t+"\n"+i;throw console.log(o),new Error(o)},write:function(e,n){this.canShowMessage(e)&&console.log(n)},writeln:function(e,n){this.canShowMessage(e)&&console.log(n+"\n")}};exports.initialize=function(){return INTERPRETER.initialize()},exports.loadCode=function(e){return INTERPRETER.loadCode(e)},exports.getCode=function(){return INTERPRETER.code};
function Stmt(t,e){if(this.interpreter=t,this.body=e,this.lineNum=this.interpreter.getCurrentLineNum(),this.codeLine=this.interpreter.getCurrentLine(),this.tokenizedCode=this.interpreter.getCurrentLineTokens(),this.stmt={},this.stmtType=null,this.stmtType=TERMINALS.searchForTerminal(type[0],"STMTTYPES"),this.stmtType)if(this.stmtType==TERMINALS.STMTTYPES.VARDECL)this.stmt=new Vardecl(this.interpreter,this.body);else if(this.stmtType==TERMINALS.STMTTYPES.ASSIGN)this.stmt=new Assignment(this.interpreter,this.body);else if(this.stmtType==TERMINALS.STMTTYPES.METHODDEFINE)this.stmt=new MethodDefine(this.interpreter,this.body);else if(this.stmtType==TERMINALS.STMTTYPES.METHOD){var i=this.code.substring(this.code.length-1);i!=TERMINALS.STMTTYPES.SEMICOLON&&this.interpreter.error("METHOD",this.lineNum,this.codeLine,"Missing Semicolon"),this.stmt=new Method(this.interpreter,this.body,this.codeLine.substring(0,this.code.length-1))}else this.stmtType==TERMINALS.STMTTYPES.RETURN?this.stmt=new Return(this.interpreter,this.body):this.stmtType==TERMINALS.STMTTYPES.IF?this.stmt=new If(this.interpreter,this.body):this.stmtType==TERMINALS.STMTTYPES.ELSEIF?this.interpreter.error("STMT",this.lineNum,this.code,"ELSEIF must follow IF"):this.stmtType==TERMINALS.STMTTYPES.ELSE?this.interpreter.error("STMT",this.lineNum,this.code,"ELSE must follow IF or ELSEIF"):this.stmtType==TERMINALS.STMTTYPES.LOOPUNTIL?this.stmt=new LoopUntil(this.interpreter,this.body):this.stmtType==TERMINALS.STMTTYPES.LOOPFOR?this.stmt=new LoopFor(this.interpreter,this.body):this.stmtType==TERMINALS.STMTTYPES.WAITUNTIL?this.stmt=new WaitUntil(this.interpreter,this.body):this.stmtType==TERMINALS.STMTTYPES.WAITFOR&&(this.stmt=new WaitFor(this.interpreter,this.body));else this.interpreter.error("STMT",this.lineNum,this.code,"STMT type is not valid.")}Stmt.prototype.type=function(){return this.stmtType},Stmt.prototype.getStmt=function(){return this.stmt},Stmt.prototype.print=function(){stmt.print()};
function StmtList(t,e){for(this.interpreter=t,this.body=e,this.stmt={},this.nextStmt={};0===this.interpreter.getCurrentLine().trim().length;)this.interpreter.goToNextLine();this.interpreter.getCurrentLineNum()!=this.body.getFinishLine()&&(this.stmt=new Stmt(this.interpreter,this.body,this.code)),t.goToNextLine(),null!==this.interpreter.getCurrentLine()&&this.interpreter.getCurrentLineNum()!=this.body.getFinishLine()&&(this.nextStmt=new StmtList(this.interpreter,this.body))}StmtList.prototype.getStmt=function(){return this.stmt},StmtList.prototype.getNextStmt=function(){return this.nextStmt},StmtList.prototype.print=function(){null!==this.stmt?(this.stmt.print(),this.interpreter.write("parse","\n"),null!==this.nextStmt&&this.nextStmt.print()):this.interpreter.writeln("parse","EMPTY STMTLIST")};
var TERMINALS={SYMBOLS:{OPENPAREN:"(",CLOSEPAREN:")",OPENBRACE:"{",CLOSEBRACE:"}",OPENBRACKET:"[",CLOSEBRACKET:"]",QUOTE:'"',SEMICOLON:";",EQUALS:"=",COMMA:",",EQ:"==",NEQ:"!=",LT:"<",GT:">",LTE:"<=",GTE:">=",DASH:"-"},comparators:[this.EQ,this.NEQ,this.LT,this.GT,this.LTE,this.GTE],VOID:"void",INT:"int",STRING:"string",BOOL:"bool",TRUE:"true",FALSE:"false",AND:"and",OR:"or",VAR:"var",dataTypes:[this.VOID,this.INT,this.STRING,this.BOOL],logOps:[this.AND,this.OR],booleanVals:[this.TRUE,this.FALSE],STMTTYPES:{ASSIGN:"assign",VARDECL:"vardecl",METHODDEFINE:"methoddefine",METHOD:"method",RETURN:"return",IF:"if",ELSEIF:"elseif",ELSE:"else",LOOPUNTIL:"loopuntil",LOOPFOR:"loopfor",WAITUNTIL:"waituntil",WAITFOR:"waitfor"},callTypes:[this.VAR,this.METHOD],reservedWords:[this.OPENPAREN,this.CLOSEPAREN,this.OPENBRACE,this.CLOSEBRACE,this.OPENBRACKET,this.CLOSEBRACKET,this.QUOTE,this.SEMICOLON,this.COMMA,this.EQ,this.NEQ,this.LTE,this.GTE,this.EQUALS,this.LT,this.GT,this.DASH,this.VOID,this.INT,this.STRING,this.BOOL,this.AND,this.OR,this.TRUE,this.FALSE,this.ASSIGN,this.VARDECL,this.METHODDEFINE,this.METHOD,this.RETURN,this.IF,this.ELSEIF,this.ELSE,this.LOOPUNTIL,this.LOOPFOR,this.WAITUNTIL,this.WAITFOR,this.VAR,this.METHOD],searchForTerminal:function(i,t){if(null!==this[t])for(var s in this[t])if(this[t].hasOwnProperty(s)&&i.indexOf(this[t][s])>-1)return this[t][s];return FALSE}};